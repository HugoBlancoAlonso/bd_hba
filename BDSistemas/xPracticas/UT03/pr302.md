```python
import pandas as pd
%cd UT03
```

    [Errno 2] No such file or directory: 'UT03'
    /home/jovyan/work/UT03


# CSV


```python
dfNorte = pd.read_csv("ventas_norte_v2.csv", sep=";")
dfNorte = dfNorte.rename(columns={
                            "ID_Pedido": "id_transaccion", 
                            "Fecha_Transaccion": "fecha", 
                            "Producto": "producto", 
                            "Unidades": "cantidad",
                            "Total_Factura": "total_venta",
                            "Direccion_Envio": "ciudad"
                            }
                        )
dfNorte["region"] = "Norte"
dfNorte = dfNorte.drop(columns=["Cliente_Nombre", "Precio_Unitario"], axis=1)
dfNorte["total_venta"] = dfNorte["total_venta"].str.replace("$", "")
dfNorte["total_venta"] = pd.to_numeric(dfNorte["total_venta"])
dfNorte.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_transaccion</th>
      <th>fecha</th>
      <th>ciudad</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>total_venta</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>N-1000</td>
      <td>2023-05-10 03:00:00</td>
      <td>Gran Vía, 49, Piso 4</td>
      <td>Laptop Gamer</td>
      <td>1</td>
      <td>970.0</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>1</th>
      <td>N-1001</td>
      <td>2023-06-18 09:00:00</td>
      <td>Av. Libertad, 30, Piso 4</td>
      <td>Mouse Ergonómico</td>
      <td>4</td>
      <td>3708.0</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>2</th>
      <td>N-1002</td>
      <td>2023-03-10 05:00:00</td>
      <td>Av. Libertad, 98, Piso 2</td>
      <td>Monitor 4K</td>
      <td>2</td>
      <td>2820.0</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>3</th>
      <td>N-1003</td>
      <td>2023-05-10 03:00:00</td>
      <td>Paseo Gracia, 94, Piso 7</td>
      <td>Webcam HD</td>
      <td>2</td>
      <td>2538.0</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N-1004</td>
      <td>2023-02-25 17:00:00</td>
      <td>Calle Mayor, 80, Piso 8</td>
      <td>Webcam HD</td>
      <td>2</td>
      <td>908.0</td>
      <td>Norte</td>
    </tr>
  </tbody>
</table>
</div>



# XLSX


```python
dfSur = pd.read_excel("ventas_sur_v2.xlsx" , sheet_name=None)
dfSur = pd.concat(dfSur.values(), ignore_index=True)

dfSur = dfSur.rename(columns={
                            "Ref_Venta": "id_transaccion", 
                            "Fecha_Alta": "fecha", 
                            "Articulo": "producto", 
                            "Cantidad": "cantidad"
                            }
                        )
dfSur["region"] = "Sur"
dfSur["ciudad"] = ""
dfSur["total_venta"] = (dfSur["Precio_Base"] * dfSur["cantidad"] * (1 - dfSur["Descuento_Aplicado"]))
dfSur = dfSur.drop(columns=["Precio_Base", "Descuento_Aplicado"])
dfSur.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_transaccion</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>Es_Cliente_Corporativo</th>
      <th>Estado_Envio</th>
      <th>region</th>
      <th>ciudad</th>
      <th>total_venta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S-5000</td>
      <td>2023-02-11 00:00:00</td>
      <td>Webcam HD</td>
      <td>9</td>
      <td>False</td>
      <td>Enviado</td>
      <td>Sur</td>
      <td></td>
      <td>3060.864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S-5001</td>
      <td>2023-02-03 12:00:00</td>
      <td>Teclado Mecánico</td>
      <td>8</td>
      <td>True</td>
      <td>Devuelto</td>
      <td>Sur</td>
      <td></td>
      <td>4796.800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S-5002</td>
      <td>2023-04-06 07:00:00</td>
      <td>Mouse Ergonómico</td>
      <td>6</td>
      <td>False</td>
      <td>Completado</td>
      <td>Sur</td>
      <td></td>
      <td>5828.160</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S-5003</td>
      <td>2023-04-02 05:00:00</td>
      <td>Monitor 4K</td>
      <td>1</td>
      <td>True</td>
      <td>Pendiente</td>
      <td>Sur</td>
      <td></td>
      <td>719.694</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S-5004</td>
      <td>2023-06-17 12:00:00</td>
      <td>Mouse Ergonómico</td>
      <td>2</td>
      <td>True</td>
      <td>Devuelto</td>
      <td>Sur</td>
      <td></td>
      <td>1177.981</td>
    </tr>
  </tbody>
</table>
</div>



# JSON


```python
import json

with open('ventas_este_v2.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

dfEste = pd.json_normalize(data)

columnas_deseadas = {
    'data.id_registro': 'id_transaccion',
    'data.payload.fecha_evento': 'fecha',
    'data.payload.comprador.ubicacion.ciudad': 'ciudad',
    'data.payload.transaccion.detalles_producto.nombre_comercial': 'producto',
    'data.payload.transaccion.cantidad_comprada': 'cantidad',
    'data.payload.transaccion.detalles_producto.precio_lista': 'precio_lista',
    'data.payload.transaccion.detalles_producto.impuestos.monto_iva': 'monto_iva'
}



dfEste = dfEste[list(columnas_deseadas.keys())].rename(columns=columnas_deseadas)
dfEste['fecha'] = dfEste['fecha'].str.replace(" 00:00:00", "")
dfEste["region"] = "Este"
dfEste.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_transaccion</th>
      <th>fecha</th>
      <th>ciudad</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>precio_lista</th>
      <th>monto_iva</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>E-8000</td>
      <td>2023-06-29</td>
      <td>Sevilla</td>
      <td>Monitor 4K</td>
      <td>1</td>
      <td>503</td>
      <td>105.63</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E-8001</td>
      <td>2023-04-12</td>
      <td>Sevilla</td>
      <td>Webcam HD</td>
      <td>1</td>
      <td>1122</td>
      <td>235.62</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E-8002</td>
      <td>2023-04-20</td>
      <td>Sevilla</td>
      <td>Webcam HD</td>
      <td>2</td>
      <td>994</td>
      <td>208.74</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>3</th>
      <td>E-8003</td>
      <td>2023-04-14</td>
      <td>Madrid</td>
      <td>Webcam HD</td>
      <td>2</td>
      <td>1255</td>
      <td>263.55</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E-8004</td>
      <td>2023-01-03</td>
      <td>Sevilla</td>
      <td>Monitor 4K</td>
      <td>2</td>
      <td>1458</td>
      <td>306.18</td>
      <td>Este</td>
    </tr>
  </tbody>
</table>
</div>




```python
dfs = [dfSur, dfNorte, dfEste]

dfFinal = pd.concat(dfs, ignore_index=True)
dfFinal.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_transaccion</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>Es_Cliente_Corporativo</th>
      <th>Estado_Envio</th>
      <th>region</th>
      <th>ciudad</th>
      <th>total_venta</th>
      <th>precio_lista</th>
      <th>monto_iva</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S-5000</td>
      <td>2023-02-11 00:00:00</td>
      <td>Webcam HD</td>
      <td>9</td>
      <td>False</td>
      <td>Enviado</td>
      <td>Sur</td>
      <td></td>
      <td>3060.864</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S-5001</td>
      <td>2023-02-03 12:00:00</td>
      <td>Teclado Mecánico</td>
      <td>8</td>
      <td>True</td>
      <td>Devuelto</td>
      <td>Sur</td>
      <td></td>
      <td>4796.800</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S-5002</td>
      <td>2023-04-06 07:00:00</td>
      <td>Mouse Ergonómico</td>
      <td>6</td>
      <td>False</td>
      <td>Completado</td>
      <td>Sur</td>
      <td></td>
      <td>5828.160</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S-5003</td>
      <td>2023-04-02 05:00:00</td>
      <td>Monitor 4K</td>
      <td>1</td>
      <td>True</td>
      <td>Pendiente</td>
      <td>Sur</td>
      <td></td>
      <td>719.694</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S-5004</td>
      <td>2023-06-17 12:00:00</td>
      <td>Mouse Ergonómico</td>
      <td>2</td>
      <td>True</td>
      <td>Devuelto</td>
      <td>Sur</td>
      <td></td>
      <td>1177.981</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


