```python
import pandas as pd
```


```python
# def convert(euros):
#     return int(euros)*0.90

# df = pd.read_csv(
#                 "datos.cdv", 
#                 converters = {"Salario_Anual": convert})
```

### CSV


```python
dfNorte = pd.read_csv("./UT03/ventas_norte.csv", sep=";")

dfNorte = dfNorte.rename(columns={
                            "ID_Transaccion": "id", 
                            "Fecha_Venta": "fecha", 
                            "Nom_Producto": "producto", 
                            "Cantidad_Vendida": "cantidad",
                            "Precio_Unit": "precio_unitario"
                            }
                        )
dfNorte["region"] = "Norte"
dfNorte.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>precio_unitario</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>2023-02-21</td>
      <td>Laptop</td>
      <td>4</td>
      <td>423</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>2023-01-15</td>
      <td>Laptop</td>
      <td>2</td>
      <td>171</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1002</td>
      <td>2023-03-13</td>
      <td>Laptop</td>
      <td>3</td>
      <td>73</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1003</td>
      <td>2023-03-02</td>
      <td>Teclado</td>
      <td>1</td>
      <td>139</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1004</td>
      <td>2023-01-21</td>
      <td>Monitor</td>
      <td>4</td>
      <td>692</td>
      <td>Norte</td>
    </tr>
  </tbody>
</table>
</div>



### XSLX


```python
dfSur = pd.read_excel("./UT03/ventas_sur.xlsx" , sheet_name=None)
dfSur = pd.concat(dfSur.values(), ignore_index=True)

dfSur = dfSur.rename(columns={
                            "SalesID": "id", 
                            "Date": "fecha", 
                            "Item": "producto", 
                            "Qty": "cantidad",
                            "UnitPrice": "precio_unitario"
                            }
                        )
dfSur["region"] = "Sur"
dfSur["fecha"] = dfSur["fecha"].astype(str)
dfSur["fecha"] = dfSur["fecha"].str.replace(" 00:00:00", "")
dfSur.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>precio_unitario</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>2023-03-01</td>
      <td>Monitor</td>
      <td>6</td>
      <td>624</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>2023-03-04</td>
      <td>Laptop</td>
      <td>7</td>
      <td>941</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>2023-03-26</td>
      <td>Mouse</td>
      <td>3</td>
      <td>989</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003</td>
      <td>2023-02-01</td>
      <td>Webcam</td>
      <td>3</td>
      <td>621</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004</td>
      <td>2023-03-28</td>
      <td>Mouse</td>
      <td>5</td>
      <td>437</td>
      <td>Sur</td>
    </tr>
  </tbody>
</table>
</div>



### JSON


```python
import json

with open("./UT03/ventas_este.json", "r", encoding="utf-8") as f:
    data = json.load(f)
dfEste = pd.json_normalize(data, sep="_")
dfEste = dfEste.rename(columns={
                            "id_orden": "id", 
                            "timestamp": "fecha", 
                            "detalles_producto_nombre": "producto", 
                            "detalles_producto_specs_cantidad": "cantidad",
                            "detalles_producto_specs_precio": "precio_unitario"
                            }
                        )
dfEste["region"] = "Este"
dfEste = dfEste.drop(columns=["detalles_producto_categoria", "cliente_nombre", "cliente_email"], axis=1)
dfEste["id"] = dfEste["id"].str.replace("ORD-", "")
dfEste["fecha"] = dfEste["fecha"].str.replace(" 00:00:00", "")
dfEste.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>precio_unitario</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3000</td>
      <td>2023-03-09</td>
      <td>Monitor</td>
      <td>2</td>
      <td>244</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3001</td>
      <td>2023-01-20</td>
      <td>Laptop</td>
      <td>2</td>
      <td>578</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3002</td>
      <td>2023-01-01</td>
      <td>Mouse</td>
      <td>2</td>
      <td>339</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3003</td>
      <td>2023-02-07</td>
      <td>Webcam</td>
      <td>2</td>
      <td>158</td>
      <td>Este</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3004</td>
      <td>2023-03-18</td>
      <td>Monitor</td>
      <td>1</td>
      <td>692</td>
      <td>Este</td>
    </tr>
  </tbody>
</table>
</div>



### Consolidación


```python
dfTotal = pd.DataFrame()

dfs = [dfNorte, dfSur, dfEste]
dfTotal = pd.concat(dfs, ignore_index=True)

dfTotal.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>fecha</th>
      <th>producto</th>
      <th>cantidad</th>
      <th>precio_unitario</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>2023-02-21</td>
      <td>Laptop</td>
      <td>4</td>
      <td>423</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>2023-01-15</td>
      <td>Laptop</td>
      <td>2</td>
      <td>171</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1002</td>
      <td>2023-03-13</td>
      <td>Laptop</td>
      <td>3</td>
      <td>73</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1003</td>
      <td>2023-03-02</td>
      <td>Teclado</td>
      <td>1</td>
      <td>139</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1004</td>
      <td>2023-01-21</td>
      <td>Monitor</td>
      <td>4</td>
      <td>692</td>
      <td>Norte</td>
    </tr>
  </tbody>
</table>
</div>



### Exportación Estandarizada


```python
dfTotal.to_csv("./UT03/ventas_consolidadas.csv", sep=",", encoding="utf-8", index=False)
```
