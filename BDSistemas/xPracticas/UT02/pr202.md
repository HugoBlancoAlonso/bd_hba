```python
!pip install redis
```

    Defaulting to user installation because normal site-packages is not writeable
    Collecting redis
      Downloading redis-7.0.1-py3-none-any.whl.metadata (12 kB)
    Downloading redis-7.0.1-py3-none-any.whl (339 kB)
    Installing collected packages: redis
    Successfully installed redis-7.0.1


    
    [notice] A new release of pip is available: 25.2 -> 25.3
    [notice] To update, run: C:\Python313\python.exe -m pip install --upgrade pip



```python
import redis
import json
```


```python
r = redis.Redis(
    host='redis',
    port=6379,
    db=0,
    decode_responses=True
)
```


```python
actual_id = 1

def next_id():
    global actual_id
    id = "id_" + str(actual_id).zfill(4)
    actual_id = actual_id + 1
    return id
```


```python
def agregar_pedido(cliente, producto, urg):

    if urg == "T":
        nuevoPedido = {
        "id": next_id(),
        "cliente": cliente,
        "producto": producto,
        "cantidad": 1,
        "urgente": True
        }
        pedido_json = json.dumps(nuevoPedido)
        r.lpush("Pedidos", pedido_json)

    else:
        nuevoPedido = {
        "id": next_id(),
        "cliente": cliente,
        "producto": producto,
        "cantidad": 1,
        "urgente": False
        }
        pedido_json = json.dumps(nuevoPedido)
        r.rpush("Pedidos", pedido_json)
    
```


```python
def procesar_pedido():
    pedido_json= r.lpop("Pedidos")
    pedido = json.loads(pedido_json)
    return pedido

```


```python
for i in range(5):
    cliente = input("Nombre del cliente:")
    producto = input("Producto: ")
    urg = input("Es urgente(T/F): ")
    agregar_pedido(cliente, producto, urg)
```


```python
print(r.lrange("Pedidos", 0, -1))
```

    7



```python
for i in range(2):
    cliente = input("Nombre del cliente:")
    producto = input("Producto: ")
    agregar_pedido(cliente, producto)
```


```python
cant = len(r.lrange("Pedidos", 0, -1))

for i in range(cant):
    pedido = procesar_pedido()
    print(pedido)
```

    {'id': 'id_0001', 'cliente': 'SAD', 'producto': 'ASD', 'cantidad': 1, 'urgente': True}
    {'id': 'id_0001', 'cliente': 'asd', 'producto': 'asd', 'cantidad': 1, 'urgente': False}
    {'id': 'id_0001', 'cliente': 'ADSAD', 'producto': 'ADS', 'cantidad': 1, 'urgente': False}
    {'id': 'id_0001', 'cliente': 'AD', 'producto': 'AD', 'cantidad': 1, 'urgente': False}
    {'id': 'id_0001', 'cliente': 'DDAS', 'producto': 'SAD', 'cantidad': 1, 'urgente': False}



```python

```
